<!-- Text input -->

<ng-template #text>
  <mat-form-field appearance="outline">
    <mat-label>{{
      options.label ?? options.inputName ?? 'NOT SET' | labelcase
    }}</mat-label>
    <input
      #input="matInput"
      type="text"
      matInput
      [formControl]="formControl"
      [wtSetAttribute]="options"
      (input)="typingChecker.next(true)"
      autocomplete="off"
    />
    <mat-icon
      matPrefix
      class="fill"
      [color]="input.errorState ? 'warn' : 'primary'"
    >
      {{ options.icon ?? 'info' }}
    </mat-icon>

    @if($isTyping | async ){
    <mat-spinner matSuffix [diameter]="20"></mat-spinner>
    } @else if(formControl.touched && formControl.valid){
    <mat-icon style="color: green" matSuffix> check</mat-icon>
    }

    <mat-error>{{ errorMessage() }}</mat-error>
  </mat-form-field>
</ng-template>

<!-- Number input -->
<ng-template #number>
  <mat-form-field appearance="outline">
    <mat-label>{{
      options.label ?? options.inputName ?? 'NOT SET' | labelcase
    }}</mat-label>
    <input
      type="number"
      matInput
      [formControl]="formControl"
      [wtSetAttribute]="options"
      (input)="typingChecker.next(true)"
      autocomplete="off"
    />
    <mat-icon matPrefix class="fill" color="primary">
      {{ options.icon ?? 'info' }}
    </mat-icon>

    @if($isTyping | async ){
    <mat-spinner matSuffix [diameter]="20"></mat-spinner>
    } @else if(formControl.touched && formControl.valid){
    <mat-icon style="color: green" matSuffix> check</mat-icon>
    }

    <mat-error>{{ errorMessage() }}</mat-error>
  </mat-form-field>
</ng-template>

@if(formControl) {
<!-- Text input -->
@if(options.type ==='text'){

<ng-container *ngTemplateOutlet="text"></ng-container>

<!-- Number input -->
} @else if(options.type ==='number') {

<ng-container *ngTemplateOutlet="number"></ng-container>
} }
