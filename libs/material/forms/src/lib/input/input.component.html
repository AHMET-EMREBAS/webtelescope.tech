<ng-container *ngIf="formControl">
  <!-- Generic form field -->
  <ng-template #formField let-type="type">
    <mat-form-field appearance="outline">
      <mat-label>{{
        options.label ?? options.name ?? 'NOT SET' | labelcase
      }}</mat-label>
      <input
        #input="matInput"
        [type]="type"
        matInput
        [formControl]="formControl"
        [wtSetAttribute]="options"
        (input)="typingChecker.next(true)"
        autocomplete="off"
      />
      <mat-icon
        matPrefix
        class="fill"
        [color]="input.errorState ? 'warn' : 'primary'"
      >
        {{ options.icon ?? 'info' }}
      </mat-icon>

      @if($isTyping | async ){
      <mat-spinner matSuffix [diameter]="20"></mat-spinner>
      } @else if(formControl.touched && formControl.valid){
      <mat-icon style="color: green" matSuffix> check</mat-icon>
      }

      <mat-error>{{ errorMessage() }}</mat-error>
    </mat-form-field>
  </ng-template>

  <!-- text field -->
  <ng-template #text>
    <ng-container
      *ngTemplateOutlet="formField; context: { type: 'text' }"
    ></ng-container>
  </ng-template>

  <!-- Number field -->
  <ng-template #number>
    <ng-container
      *ngTemplateOutlet="formField; context: { type: 'number' }"
    ></ng-container>
  </ng-template>

  @if(formControl) {
  <!-- Text input -->
  @if(options.inputType ==='text'){
  <ng-container *ngTemplateOutlet="text"></ng-container>
  <!-- Number input -->
  } @else if(options.inputType ==='number') {

  <ng-container *ngTemplateOutlet="number"></ng-container>
  } } @else {

  <ng-container *ngTemplateOutlet="text"></ng-container>

  }
</ng-container>
